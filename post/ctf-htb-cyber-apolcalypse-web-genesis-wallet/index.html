<!doctype html><html lang=en data-figures class=page><head><title>CTF Writeup: 2022 HTB Cyber Apolcalypse Web Challenge: Genesis Wallet | A developer's notes in the world of security research and bug bounty, by pmnh</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta http-equiv=x-ua-compatible content="IE=edge"><script async src="https://www.googletagmanager.com/gtag/js?id=G-0MD8T00339"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0MD8T00339")</script><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta name=description content="CTF Writeup: 2022 HTB Cyber Apolcalypse Web Challenge: Genesis Wallet"><meta name=twitter:card content="summary"><meta name=twitter:creator content="@pmnh_"><meta name=twitter:title content="CTF Writeup: 2022 HTB Cyber Apolcalypse Web Challenge: Genesis Wallet"><meta property="og:url" content="https://h1pmnh.github.io/post/ctf-htb-cyber-apolcalypse-web-genesis-wallet/"><meta property="og:title" content="CTF Writeup: 2022 HTB Cyber Apolcalypse Web Challenge: Genesis Wallet"><meta property="og:description" content="CTF Writeup: 2022 HTB Cyber Apolcalypse Web Challenge: Genesis Wallet"><meta property="og:image" content="https://h1pmnh.github.io/images/thumbnail.png"><link rel=apple-touch-icon sizes=180x180 href=https://h1pmnh.github.io/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://h1pmnh.github.io/icons/favicon-32x32.png><link rel=manifest href=https://h1pmnh.github.io/icons/site.webmanifest><link rel=canonical href=https://h1pmnh.github.io/post/ctf-htb-cyber-apolcalypse-web-genesis-wallet/><link rel=preload href=https://h1pmnh.github.io/css/styles.54eab6953ed04c3ee282968d1e1b85fed84d551aee762f927a0860811bc873413381a397ea6b9db08a0966e77b1ecf467680006010b3e82c4ba7efa8fec6656b.css integrity="sha512-VOq2lT7QTD7igpaNHhuF/thNVRrudi+SeghggRvIc0EzgaOX6mudsIoJZud7Hs9GdoAAYBCz6CxLp++o/sZlaw==" as=style crossorigin=anonymous><link rel=preload href=https://h1pmnh.github.io/en/js/bundle.19668860ea177cfe8cad686c7464b57e39acde1a4c33f6a1a8c57f7ab127ac39e8330b38e7184422cf0e9351ef3efaf75d122eca818d38a929941b8a5c04b09e.js as=script integrity="sha512-GWaIYOoXfP6MrWhsdGS1fjms3hpMM/ahqMV/erEnrDnoMws45xhEIs8Ok1HvPvr3XRIuyoGNOKkplBuKXASwng==" crossorigin=anonymous><link rel=stylesheet type=text/css href=https://h1pmnh.github.io/css/styles.54eab6953ed04c3ee282968d1e1b85fed84d551aee762f927a0860811bc873413381a397ea6b9db08a0966e77b1ecf467680006010b3e82c4ba7efa8fec6656b.css integrity="sha512-VOq2lT7QTD7igpaNHhuF/thNVRrudi+SeghggRvIc0EzgaOX6mudsIoJZud7Hs9GdoAAYBCz6CxLp++o/sZlaw==" crossorigin=anonymous></head><body data-code=20 data-lines=false id=documentTop><header class=nav_header><nav class=nav><a href=https://h1pmnh.github.io/ class="nav_brand nav_item" title="A developer's notes in the world of security research and bug bounty, by pmnh">A developer's notes in the world of security research and bug bounty, by pmnh<div class=nav_close><div><svg class="icon"><title>open-menu</title><use xlink:href="#open-menu"/></svg><svg class="icon"><title>closeme</title><use xlink:href="#closeme"/></svg></div></div></a><div class='nav_body nav_body_left'><div class=nav_parent><a href=https://h1pmnh.github.io/ class=nav_item title=Home>Home</a></div><div class=nav_parent><a href=https://h1pmnh.github.io/about/ class=nav_item title=About>About</a></div><div class=follow><a href=https://github.com/h1pmnh><svg class="icon"><title>github</title><use xlink:href="#github"/></svg></a><a href=https://twitter.com/pmnh_><svg class="icon"><title>twitter</title><use xlink:href="#twitter"/></svg></a><a href=https://h1pmnh.github.io/index.xml><svg class="icon"><title>rss</title><use xlink:href="#rss"/></svg></a><div class=color_mode><input type=checkbox class=color_choice id=mode></div></div></div></nav></header><main><div class="grid-inverse wrap content"><article class=post_content><h1 class=post_title>CTF Writeup: 2022 HTB Cyber Apolcalypse Web Challenge: Genesis Wallet</h1><div class=post_meta><span><svg class="icon"><title>calendar</title><use xlink:href="#calendar"/></svg></span><span class=post_date>May 19, 2022</span>
<span class=post_time>· 11 min read</span><span>&nbsp;· <a href=https://h1pmnh.github.io/tags/ctf title=ctf class="post_tag button button_translucent">ctf
</a><a href=https://h1pmnh.github.io/tags/nodejs title=nodejs class="post_tag button button_translucent">nodejs
</a><a href=https://h1pmnh.github.io/tags/varnish title=varnish class="post_tag button button_translucent">varnish
</a><a href=https://h1pmnh.github.io/tags/csrf title=csrf class="post_tag button button_translucent">csrf</a></span>
<span class=page_only>&nbsp;·<div class=post_share>Share on:
<a href="https://twitter.com/intent/tweet?text=CTF%20Writeup%3a%202022%20HTB%20Cyber%20Apolcalypse%20Web%20Challenge%3a%20Genesis%20Wallet&url=https%3a%2f%2fh1pmnh.github.io%2fpost%2fctf-htb-cyber-apolcalypse-web-genesis-wallet%2f&tw_p=tweetbutton" class=twitter title="Share on Twitter" target=_blank rel=nofollow><svg class="icon"><title>twitter</title><use xlink:href="#twitter"/></svg></a><a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fh1pmnh.github.io%2fpost%2fctf-htb-cyber-apolcalypse-web-genesis-wallet%2f&t=CTF%20Writeup%3a%202022%20HTB%20Cyber%20Apolcalypse%20Web%20Challenge%3a%20Genesis%20Wallet" class=facebook title="Share on Facebook" target=_blank rel=nofollow><svg class="icon"><title>facebook</title><use xlink:href="#facebook"/></svg></a><a href=#linkedinshare id=linkedinshare class=linkedin title="Share on LinkedIn" rel=nofollow><svg class="icon"><title>linkedin</title><use xlink:href="#linkedin"/></svg></a><a href=https://h1pmnh.github.io/post/ctf-htb-cyber-apolcalypse-web-genesis-wallet/ title="Copy Link" class="link link_yank"><svg class="icon"><title>copy</title><use xlink:href="#copy"/></svg></a></div></span></div><div class=post_toc><h2>Overview</h2><nav id=TableOfContents><ul><li><a href=#summary>Summary</a></li><li><a href=#setup>Setup</a></li><li><a href=#application-architecture>Application Architecture</a></li><li><a href=#finding-the-flag>Finding the Flag</a></li><li><a href=#initial-setup---new-account>Initial Setup - New Account</a></li><li><a href=#finding-the-tokens>Finding the Tokens</a></li><li><a href=#steps-to-transfer-funds>Steps to Transfer Funds</a></li><li><a href=#framing-the-solution-csrf-via-img-tag>Framing the Solution: CSRF via <code>&lt;img></code> tag</a><ul><li><a href=#side-quest-finding-icaruss-wallet>Side Quest: Finding <code>icarus</code>'s Wallet</a></li><li><a href=#next-steps-finding-a-csrf>Next Steps: Finding a CSRF</a></li><li><a href=#explainer-otp-keys-and-2fa-via-totp>Explainer: OTP Keys and 2FA via TOTP</a></li><li><a href=#confirming-the-csrf>Confirming the CSRF</a></li></ul></li><li><a href=#the-final-puzzle-piece---grabbing-the-otp-secret>The Final Puzzle Piece - Grabbing the OTP secret</a></li><li><a href=#assembling-the-final-payload>Assembling the Final Payload</a></li><li><a href=#finishing-up>Finishing Up</a></li><li><a href=#final-thoughts>Final Thoughts</a></li></ul></nav></div><div class=post_body><h2 id=summary>Summary</h2><p>Genesis Wallet was one of the harder web challenges in the 2022 Hack the Box (HTB) CTF. Our team composed of Synack Red Team members finished a respectable 21st place, unfortunately we were very close to solving this challenge and literally were about 5 minutes from a successful solve when time expired - so sad!</p><p>Personally I thought this was a very clever challenge and probably one of the best designed web challenges in any CTF I've done to date, so I thought I'd share it with interested readers.</p><h2 id=setup>Setup</h2><p>You are presented with the Genesis Wallet system, an online site that is used to transfer <code>GTC</code> tokens from one wallet address to another. You are provided with a set of credentials (username <code>icarus</code> and corresponding password) for a wallet and can log in using these credentials - BUT the site is protected by 2FA and requires you to also have an OTP code to log in.</p><p>As with the other HTB CTF challenges, we're provided with the full code of the application, which makes finding the path to the flag slightly easier.</p><h2 id=application-architecture>Application Architecture</h2><p>This application is a NodeJS application running in a Docker container. It is fronted by a Varnish proxy server and has a SQLite database behind it.</p><h2 id=finding-the-flag>Finding the Flag</h2><p>With many of the white box challenges in this CTF, it is fairly easy to locate where the flag is available - the challenge is getting to it in the running web application!</p><p>In this case we can look at the <code>routes/index.js</code> file and see that the flag is displayed on the main application dashboard under certain conditions:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=sr>/^\/(\w{2})?\/?dashboard/</span><span class=p>,</span> <span class=nx>AuthMiddleware</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>	<span class=kd>let</span> <span class=nx>lang</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>params</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>lang</span><span class=p>)</span> <span class=nx>lang</span> <span class=o>=</span> <span class=s1>&#39;en&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>
</span></span><span class=line><span class=ln>5</span><span class=cl>	<span class=k>return</span> <span class=nx>db</span><span class=p>.</span><span class=nx>getUser</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>.</span><span class=nx>username</span><span class=p>)</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>		<span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>user</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>			<span class=kd>let</span> <span class=nx>flag</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=ln>8</span><span class=cl>			<span class=k>if</span> <span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>balance</span> <span class=o>&gt;</span> <span class=mi>1337</span> <span class=o>&amp;&amp;</span> <span class=nx>user</span><span class=p>.</span><span class=nx>username</span> <span class=o>!=</span> <span class=s1>&#39;icarus&#39;</span><span class=p>)</span> <span class=nx>flag</span> <span class=o>=</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;/flag.txt&#39;</span><span class=p>).</span><span class=nx>toString</span><span class=p>();</span>
</span></span><span class=line><span class=ln>9</span><span class=cl>			<span class=nx>res</span><span class=p>.</span><span class=nx>render</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>lang</span><span class=si>}</span><span class=sb>/dashboard.html`</span><span class=p>,</span> <span class=p>{</span> <span class=nx>user</span><span class=p>,</span> <span class=nx>flag</span> <span class=p>});</span>
</span></span></code></pre></div><p>So we can see that in order to display the flag we need to satisfy the following conditions:</p><ul><li>Need to have a wallet balance which is substantial (>1337 <code>GTC</code>)</li><li>Need to be logged in as a user who is <em>not</em> <code>icarus</code> (the credentials we are provided with the challenge)</li></ul><h2 id=initial-setup---new-account>Initial Setup - New Account</h2><p>The site supports self registration functionality that proceeds as follows:</p><ul><li>Register new username / password</li><li>Log in with username / password</li><li>Register 2FA QR code with authenticator</li><li>Confirm OTP from authenticator</li></ul><p>When we create a new account, we discover that new users are granted <code>0.1 GTC</code> free into their wallet. Based on the market cap of the <code>GTC</code> token this is very generous ;)</p><p><figure><picture><img class="image_figure image_internal" src=https://h1pmnh.github.io/images/ctf-2022-htb-genesis/dashboard_new_user.png alt="Dashboard Image" loading=lazy decoding=async width=1998 height=829></picture></figure></p><p>If we need to reach a balance greater than 1337 <code>GTC</code> this will require a lot of accounts and a lot of consolidation of "free" <code>GTC</code> tokens. There must be a way to get more tokens into an account we control!</p><h2 id=finding-the-tokens>Finding the Tokens</h2><p>Let's look at how the database is seeded, maybe this will help us find a wallet with a balance? In <code>database.js</code>, which is used at startup of the NodeJS applcation to seed the database, we see the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln> 1</span><span class=cl>	<span class=kr>async</span> <span class=nx>migrate</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>		<span class=kd>let</span> <span class=nx>uOTPKey</span> <span class=o>=</span> <span class=nx>OTPHelper</span><span class=p>.</span><span class=nx>genSecret</span><span class=p>();</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>		<span class=kd>let</span> <span class=nx>uAddress</span> <span class=o>=</span> <span class=nx>crypto</span><span class=p>.</span><span class=nx>createHash</span><span class=p>(</span><span class=s1>&#39;md5&#39;</span><span class=p>).</span><span class=nx>update</span><span class=p>(</span><span class=s1>&#39;icarus&#39;</span><span class=p>).</span><span class=nx>digest</span><span class=p>(</span><span class=s2>&#34;hex&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>		<span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>db</span><span class=p>.</span><span class=nx>exec</span><span class=p>(</span><span class=sb>`
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=sb>			DROP TABLE IF EXISTS users;
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=sb>			CREATE TABLE users (
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=sb>				id         INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=sb>				username   VARCHAR(255) NOT NULL UNIQUE,
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=sb>				password   VARCHAR(255) NOT NULL,
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=sb>				balance    DOUBLE DEFAULT 0.100,
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=sb>				otpkey     VARCHAR(255) NULL,
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=sb>				address    VARCHAR(36) NOT NULL UNIQUE
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=sb>			);
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=sb>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=sb>			INSERT OR IGNORE INTO users (username, password, balance, otpkey, address)
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=sb>				VALUES (&#39;icarus&#39;, &#39;FlyHighToTheSky&#39;, 1337.10, &#39;</span><span class=si>${</span><span class=nx>uOTPKey</span><span class=si>}</span><span class=sb>&#39;, &#39;</span><span class=si>${</span><span class=nx>uAddress</span><span class=si>}</span><span class=sb>&#39;);
</span></span></span></code></pre></div><p>So we see that the user <code>icarus</code> has a wallet balance that is seeded with a little more <code>GTC</code> tokens than we need to satisfy the first flag criteria. To satisfy the second criteria, we need that balance to be in a wallet which is not controlled by the user <code>icarus</code> - so how can we manage a transfer of funds to our wallet?</p><h2 id=steps-to-transfer-funds>Steps to Transfer Funds</h2><p>After experimenting with the functionality of the site, we learn the flow to send funds from one wallet to another is as follows:</p><ul><li>Sender intiates a transaction</li><li>The transaction includes the receiver's wallet address and amount</li><li>The transaction may include a note, specified in Markdown</li><li>Sender confirms the transaction with their OTP</li><li>Receiver can see the transaction on their dashboard and the funds are added to their wallet</li></ul><p>The transaction note specified in Markdown seems interesting, and I immediately thought that this could be an easy CSRF via XSS (a theme very common in web CTF challenges), however in this case we face the dreaded DOMPurify as can be seen in the NodeJS function responsible for converting the Markdown to HTML for rendering (located in <code>helpers/MDHelper.js</code>):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln> 1</span><span class=cl><span class=kr>const</span> <span class=nx>showdown</span>        <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;showdown&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=kr>const</span> <span class=nx>createDOMPurify</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;dompurify&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>JSDOM</span> <span class=p>}</span>       <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;jsdom&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>
</span></span><span class=line><span class=ln> 5</span><span class=cl><span class=kr>const</span> <span class=nx>conv</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>showdown</span><span class=p>.</span><span class=nx>Converter</span><span class=p>({</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>	<span class=nx>completeHTMLDocument</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>  <span class=p>[...</span><span class=nx>snip</span><span class=p>...]</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl><span class=kr>const</span> <span class=nx>makeHtml</span> <span class=o>=</span> <span class=p>(</span><span class=nx>md</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>    <span class=k>return</span><span class=p>(</span><span class=nx>conv</span><span class=p>.</span><span class=nx>makeHtml</span><span class=p>(</span><span class=nx>md</span><span class=p>));</span>
</span></span><span class=line><span class=ln>11</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>12</span><span class=cl><span class=kr>const</span> <span class=nx>filterHTML</span> <span class=o>=</span> <span class=p>(</span><span class=nx>content</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>    <span class=nx>html</span> <span class=o>=</span> <span class=nx>makeHtml</span><span class=p>(</span><span class=nx>content</span><span class=p>);</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>    <span class=nb>window</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>JSDOM</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>).</span><span class=nb>window</span><span class=p>;</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>    <span class=nx>DOMPurify</span> <span class=o>=</span> <span class=nx>createDOMPurify</span><span class=p>(</span><span class=nb>window</span><span class=p>);</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>    <span class=k>return</span> <span class=nx>DOMPurify</span><span class=p>.</span><span class=nx>sanitize</span><span class=p>(</span><span class=nx>html</span><span class=p>,</span> <span class=p>{</span><span class=nx>ALLOWED_TAGS</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;strong&#39;</span><span class=p>,</span> <span class=s1>&#39;em&#39;</span><span class=p>,</span> <span class=s1>&#39;img&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;s&#39;</span><span class=p>,</span> <span class=s1>&#39;ul&#39;</span><span class=p>,</span> <span class=s1>&#39;ol&#39;</span><span class=p>,</span> <span class=s1>&#39;li&#39;</span><span class=p>]});</span>
</span></span><span class=line><span class=ln>17</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>So we see that the <code>showdown</code> converter is used to convert Markdown to HTML, and the result is run through DOMPurify with a very restricted list of supported tags. I hoped that there was some trick here where an older / vulnerable version of DOMPurify was in use (we've seen this in several CTFs recently) but unfortunately this was not the case.</p><h2 id=framing-the-solution-csrf-via-img-tag>Framing the Solution: CSRF via <code>&lt;img></code> tag</h2><p>After thinking about this for a bit, I realized that we had the potential to submit an <code>&lt;img></code> tag with an <code>src=</code> attribute that could invoke a <code>GET</code>-based CSRF attack, when the receiver (<code>icarus</code>) views the transaction.</p><h3 id=side-quest-finding-icaruss-wallet>Side Quest: Finding <code>icarus</code>'s Wallet</h3><p>Before I could test this theory, I had to solve the practical problem of not knowing what the wallet address for <code>icarus</code> was. Fortunately this was easily determined by running the code in the database seeding script in the Node CLI:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>$ node
</span></span><span class=line><span class=ln>2</span><span class=cl>&gt; crypto.createHash(&#39;md5&#39;).update(&#39;icarus&#39;).digest(&#34;hex&#34;);
</span></span><span class=line><span class=ln>3</span><span class=cl>&#39;1ea8b3ac0640e44c27b3cb8a258a87f8&#39;
</span></span></code></pre></div><h3 id=next-steps-finding-a-csrf>Next Steps: Finding a CSRF</h3><p>Fortunately there were not too many routes in this Node application, and I knew I had to find something that was <code>GET</code>-based and 2FA-related. After some code review I came upon the code to handle the initial setup (or resetting) of a user's 2FA authenticator application:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>router</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=sr>/^\/(\w{2})?\/?(setup|reset)-2fa/</span><span class=p>,</span> <span class=nx>AuthMiddleware</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>	<span class=kd>let</span> <span class=nx>lang</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>params</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>lang</span><span class=p>)</span> <span class=nx>lang</span> <span class=o>=</span> <span class=s1>&#39;en&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>	<span class=kd>let</span> <span class=nx>otpkey</span> <span class=o>=</span> <span class=nx>OTPHelper</span><span class=p>.</span><span class=nx>genSecret</span><span class=p>();</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>
</span></span><span class=line><span class=ln>6</span><span class=cl>	<span class=k>return</span> <span class=nx>db</span><span class=p>.</span><span class=nx>setOTPKey</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>.</span><span class=nx>username</span><span class=p>,</span> <span class=nx>otpkey</span><span class=p>)</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>		<span class=p>.</span><span class=nx>then</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>8</span><span class=cl>		<span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>render</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>lang</span><span class=si>}</span><span class=sb>/setup-2fa.html`</span><span class=p>,</span> <span class=p>{</span><span class=nx>otpkey</span><span class=o>:</span> <span class=nx>otpkey</span><span class=p>,</span> <span class=nx>action</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>params</span><span class=p>[</span><span class=mi>1</span><span class=p>]});</span>
</span></span></code></pre></div><p>We can see that, when invoked, this URL will generate a new OTP key for the currently logged-in user, save it to the database, and then display the key to them in their browser. Can you spot the critical bug here?</p><p>That's right - the new OTP key is saved to the database <em>before</em> being confirmed by the user. This is a pretty bad design because if the user doesn't confirm that they have scanned the QR into their authenticator app, they could be permanently locked out of their account (having reset the OTP without actually confirming that they have it!).</p><p>So, in theory this means that we can send a transaction note with the following HTML content to trigger generation of a new OTP key for the user receiving our transaction:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=ln>1</span><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;/reset-2fa&#34;</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>Of course we need to convert this into Markdown for use in the note:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=ln>1</span><span class=cl>![](/reset-2fa)
</span></span></code></pre></div><p>We have a big problem though - how does this help in our quest to steal funds from <code>icarus</code>'s wallet?</p><h3 id=explainer-otp-keys-and-2fa-via-totp>Explainer: OTP Keys and 2FA via TOTP</h3><p>As a very brief explanation of what OTP keys are - most TOTP solutions rely on the creation of a shared secret, which is known by the server and the client. They use the same algorithm, seeded with this secret, to generate (client) and confirm (server) that the time-based codes are correct.</p><p>Knowledge of this secret can lead to an attacker being able to generate their own TOTP codes which are guaranteed to be in sync with any other client as well as the server. This is well explained in the <a href="https://en.wikipedia.org/wiki/Time-based_one-time_password#:~:text=Time%2Dbased%20one%2Dtime%20password%20(TOTP)%20is%20a,(IETF)%20standard%20RFC%206238.">Wikipedia Article on TOTP codes</a>.</p><h3 id=confirming-the-csrf>Confirming the CSRF</h3><p>As a quick confirmation, we created a transaction and sent it to the <code>icarus</code> wallet address containing an image that pointed to Burp Collaborator. We confirmed that shortly after the transaction was confirmed by the sender, the <code>&lt;img></code> tag was hit. Examining the code of the application, in <code>bot.js</code> we can see that there is code to log into the application and view the "transactions" page after every confirmed transaction:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln> 1</span><span class=cl><span class=kr>const</span> <span class=nx>viewTransactions</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>		<span class=kr>const</span> <span class=nx>browser</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>puppeteer</span><span class=p>.</span><span class=nx>launch</span><span class=p>(</span><span class=nx>browser_options</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>		<span class=kd>let</span> <span class=nx>context</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>browser</span><span class=p>.</span><span class=nx>createIncognitoBrowserContext</span><span class=p>();</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>		<span class=kd>let</span> <span class=nx>page</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>context</span><span class=p>.</span><span class=nx>newPage</span><span class=p>();</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>
</span></span><span class=line><span class=ln> 7</span><span class=cl>		<span class=kd>let</span> <span class=nx>token</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>JWTHelper</span><span class=p>.</span><span class=nx>sign</span><span class=p>({</span> <span class=nx>username</span><span class=o>:</span> <span class=s1>&#39;icarus&#39;</span><span class=p>,</span> <span class=nx>otpkey</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>verified</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>		<span class=kr>await</span> <span class=nx>page</span><span class=p>.</span><span class=nx>setCookie</span><span class=p>({</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>			<span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;session&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>			<span class=s1>&#39;value&#39;</span><span class=o>:</span> <span class=nx>token</span><span class=p>,</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>			<span class=nx>domain</span><span class=o>:</span> <span class=s2>&#34;127.0.0.1&#34;</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>		<span class=p>});</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>		<span class=kr>await</span> <span class=nx>page</span><span class=p>.</span><span class=kr>goto</span><span class=p>(</span><span class=s1>&#39;http://127.0.0.1/transactions&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>			<span class=nx>waitUntil</span><span class=o>:</span> <span class=s1>&#39;networkidle2&#39;</span><span class=p>,</span>
</span></span></code></pre></div><p>So it seems we are onto something with this CSRF idea since there is clearly a headless browser that is intended to view the transaction note.</p><h2 id=the-final-puzzle-piece---grabbing-the-otp-secret>The Final Puzzle Piece - Grabbing the OTP secret</h2><p>This last piece actually took me a while to think through - we need to be able to view the content of the <code>/reset-2fa</code> page after it has been requested by <code>icarus</code> from our CSRF attack. How would we do this?</p><p>For anyone who plays CTFs regularly you know that usually "things are there for a reason" is an axiom you can follow if you get stuck for ideas. It occurred to me to look at the Varnish proxy configuration and then the final piece of the puzzle became clear. Let's look at <code>config/cache.vcl</code>, which is the Varnish Cache configuation file, written in VCL, the Varnish language. Particularly, this piece stood out to me:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln> 1</span><span class=cl>sub vcl_recv {
</span></span><span class=line><span class=ln> 2</span><span class=cl>    # Only allow caching for GET and HEAD requests
</span></span><span class=line><span class=ln> 3</span><span class=cl>    if (req.method != &#34;GET&#34; &amp;&amp; req.method != &#34;HEAD&#34;) {
</span></span><span class=line><span class=ln> 4</span><span class=cl>        return (pass);
</span></span><span class=line><span class=ln> 5</span><span class=cl>    }
</span></span><span class=line><span class=ln> 6</span><span class=cl>    # get javascript and css from cache
</span></span><span class=line><span class=ln> 7</span><span class=cl>    if (req.url ~ &#34;(\.(js|css|map)$|\.(js|css)\?version|\.(js|css)\?t)&#34;) {
</span></span><span class=line><span class=ln> 8</span><span class=cl>        return (hash);
</span></span><span class=line><span class=ln> 9</span><span class=cl>    }
</span></span><span class=line><span class=ln>10</span><span class=cl>    # get images from cache
</span></span><span class=line><span class=ln>11</span><span class=cl>    if (req.url ~ &#34;\.(svg|ico|jpg|jpeg|gif|png)$&#34;) {
</span></span><span class=line><span class=ln>12</span><span class=cl>        return (hash);
</span></span><span class=line><span class=ln>13</span><span class=cl>    }
</span></span></code></pre></div><p>We can see that Varnish is configured to cache any URL matching these regexes for static content. Crucially, it's important to note that the <code>req.url</code> value is the <em>full URL of the request</em> and not just the portion before any query string. This means that the following URL will be cached by Varnish:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>/reset-2fa?ctf.jpg
</span></span></code></pre></div><p>This was the final piece of the puzzle that was needed to grab the OTP secret. Basically, by adding a query string value that will trigger the Varnish caching of the page content, any other request to that same URL should return the <em>same content</em> until the Varnish cache TTL (in this case set to 2 minutes) expires. This should allow us to view the contents of the cached page which was rendered to <code>icarus</code> when the CSRF request took place!</p><p>This was a brilliant use of reverse cache poisoning, where we are forcing sensitive data to be cached such that an attacker can read it. Truly a brilliant design choice for this challenge!</p><h2 id=assembling-the-final-payload>Assembling the Final Payload</h2><p>We now have all the steps requires to complete the mission:</p><ul><li>Send <code>icarus</code> a small transaction with a note containing the Markdown <code>![](/reset-2fa?123.jpg)</code></li><li>When viewed, this will trigger a CSRF which will store a new OTP key in <code>icarus</code>'s database account</li><li>The content of the request will be (incorrectly) cached by Varnish</li><li>We can request the same page to see the cached content</li><li>We can use the OTP secret to configure our TOTP authenticator app to generate codes allowing us to log into the <code>icarus</code> account (as we already have the account password)</li></ul><p>Seems simple, right? I ran through this all, super excited, sent the request to <code>http://46.101.25.63:31787/reset-2fa?123.jpg</code> and.... got my own account 2FA reset - it wasn't the same OTP key that was cached. Why not!??!?!</p><p>Turns out I had overlooked a key part of the Varnish configuration at the beginning of the VCL file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln> 1</span><span class=cl>sub vcl_hash {
</span></span><span class=line><span class=ln> 2</span><span class=cl>    hash_data(req.url);
</span></span><span class=line><span class=ln> 3</span><span class=cl>
</span></span><span class=line><span class=ln> 4</span><span class=cl>    if (req.http.host) {
</span></span><span class=line><span class=ln> 5</span><span class=cl>        hash_data(req.http.host);
</span></span><span class=line><span class=ln> 6</span><span class=cl>    } else {
</span></span><span class=line><span class=ln> 7</span><span class=cl>        hash_data(server.ip);
</span></span><span class=line><span class=ln> 8</span><span class=cl>    }
</span></span><span class=line><span class=ln> 9</span><span class=cl>
</span></span><span class=line><span class=ln>10</span><span class=cl>    return (lookup);
</span></span><span class=line><span class=ln>11</span><span class=cl>}
</span></span></code></pre></div><p>The <code>vcl_hash</code> function is used to determine what elements of a request make it "unique" such that cached results can be looked up and returned (ref. VCL documentat of <a href=https://varnish-cache.org/docs/trunk/users-guide/vcl-hashing.html>hashing</a>). In this case, we can see that the Varnish hash is computed by:</p><ul><li>The URL contents</li><li>The Host header (if present) or server IP (if header is not present)</li></ul><p>So in this case, we are not seeing the cached content because the <code>icarus</code> bot is accessing it using the localhost URL as we saw above:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>		await page.goto(&#39;http://127.0.0.1/transactions&#39;, {
</span></span></code></pre></div><p>Therefore, the request <code>http://127.0.0.1/reset-2fa</code> is not equivalent to our request to the external IP address, thus we don't see the cached result. Fortunately this was an easy fix, we simply needed to change the value of the <code>Host</code> header in Burp to <code>127.0.0.1</code> to ensure we hit the same Varnish hash entry as <code>icarus</code> hit:</p><p><figure><picture><img class="image_figure image_internal" src=https://h1pmnh.github.io/images/ctf-2022-htb-genesis/burp_request_get_cached_content.png alt="Burp Request" loading=lazy decoding=async width=1694 height=1211></picture></figure></p><p>We can see in the response presumably the same OTP secret that was saved to the database under <code>icarus</code>'s account:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>		&lt;script&gt;
</span></span><span class=line><span class=ln>2</span><span class=cl>			genQRCode(&#39;PFFF2UZEMUGSAN2H&#39;);
</span></span><span class=line><span class=ln>3</span><span class=cl>		&lt;/script&gt;
</span></span></code></pre></div><h2 id=finishing-up>Finishing Up</h2><p>Now that we have the response and a QR code (we can show this page in the browser to get the QR code), the rest of the exercise was simply to log into <code>icarus</code>'s account using the stolen OTP secret, transfer funds to our own wallet, and log into our own wallet to see the flag:</p><p><figure><picture><img class="image_figure image_internal" src=https://h1pmnh.github.io/images/ctf-2022-htb-genesis/flag.png alt=Flag loading=lazy decoding=async width=1892 height=381></picture></figure></p><h2 id=final-thoughts>Final Thoughts</h2><p>Overall this was an extremely fun web challenge that required a number of creative solutions to achieve the seemingly obvious initial goal. I appreciate the designer who put this together!</p></div><div class=post_comments></div></article><aside class=sidebar><section class=sidebar_inner><br><div class=search><input type=search class="search_field form_field" placeholder=Search... id=find autocomplete=off data-scope=post>
<label for=find class=search_label><svg class="icon"><title>search</title><use xlink:href="#search"/></svg></label><div class="search_results results"></div></div><div class=sidebardisclaimer><h2 class=mt-4>Disclaimer</h2>The opinions expressed on this site are my own personal opinions and do not represent my employer’s view in any way. All content on this site should be used for legal, research purposes only on assets you are permitted to test. The author expressly disclaims any and all liability from misuse of material on this site.</div><h2 class=mt-4>Featured Posts</h2><ul><li><a href=https://h1pmnh.github.io/post/writeup_spring_el_waf_bypass/ class=nav-link title="Bug Writeup: RCE via SSTI on Spring Boot Error Page with Akamai WAF Bypass">Bug Writeup: RCE via SSTI on Spring Boot Error Page with Akamai WAF Bypass</a></li><li><a href=https://h1pmnh.github.io/post/2022-sep-2-years-bug-bounty/ class=nav-link title="Reflecting on 2 Years of Bug Bounty">Reflecting on 2 Years of Bug Bounty</a></li></ul><h2 class=mt-4>Recent Posts</h2><ul class=flex-column><li><a href=https://h1pmnh.github.io/post/writeup_spring_el_waf_bypass/ class=nav-link title="Bug Writeup: RCE via SSTI on Spring Boot Error Page with Akamai WAF Bypass">Bug Writeup: RCE via SSTI on Spring Boot Error Page with Akamai WAF Bypass</a></li><li><a href=https://h1pmnh.github.io/post/2022-sep-2-years-bug-bounty/ class=nav-link title="Reflecting on 2 Years of Bug Bounty">Reflecting on 2 Years of Bug Bounty</a></li><li><a href=https://h1pmnh.github.io/post/cve-luxcal-2021/ class=nav-link title="LuxCal 5.1.x and below Authentication Bypass: CVE-2021-45914, CVE-2021-45915">LuxCal 5.1.x and below Authentication Bypass: CVE-2021-45914, CVE-2021-45915</a></li><li><a href=https://h1pmnh.github.io/post/advanced-sqlmap-case-study-1/ class=nav-link title="Advanced sqlmap Case Study">Advanced sqlmap Case Study</a></li></ul><div><h2 class="mt-4 taxonomy" id=tags-section>Tags</h2><nav class=tags_nav><a href=https://h1pmnh.github.io/tags/advanced/ class="post_tag button button_translucent" title=advanced>ADVANCED
<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/authentication/ class="post_tag button button_translucent" title=authentication>AUTHENTICATION
<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/bugcrowd/ class="post_tag button button_translucent" title=bugcrowd>BUGCROWD
<span class=button_tally>1</span></a><br><div class="post_tags_toggle button">All Tags</div><div class=post_tags><div class=tags_list><a href=https://h1pmnh.github.io/tags/advanced/ class="post_tag button button_translucent" data-position=1 title=advanced>ADVANCED<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/authentication/ class="post_tag button button_translucent" data-position=1 title=authentication>AUTHENTICATION<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/bugcrowd/ class="post_tag button button_translucent" data-position=1 title=bugcrowd>BUGCROWD<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/csrf/ class="post_tag button button_translucent" data-position=1 title=csrf>CSRF<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/ctf/ class="post_tag button button_translucent" data-position=1 title=ctf>CTF<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/cve/ class="post_tag button button_translucent" data-position=1 title=cve>CVE<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/index/ class="post_tag button button_translucent" data-position=1 title=index>INDEX<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/learning/ class="post_tag button button_translucent" data-position=1 title=learning>LEARNING<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/nodejs/ class="post_tag button button_translucent" data-position=1 title=nodejs>NODEJS<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/rce/ class="post_tag button button_translucent" data-position=1 title=rce>RCE<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/sqli/ class="post_tag button button_translucent" data-position=1 title=sqli>SQLI<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/sqlmap/ class="post_tag button button_translucent" data-position=1 title=sqlmap>SQLMAP<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/varnish/ class="post_tag button button_translucent" data-position=1 title=varnish>VARNISH<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/waf/ class="post_tag button button_translucent" data-position=1 title=waf>WAF<span class=button_tally>1</span></a>
<a href=https://h1pmnh.github.io/tags/writeup/ class="post_tag button button_translucent" data-position=1 title=writeup>WRITEUP<span class=button_tally>1</span></a><div class=tags_sort><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span></div><span class=tags_hide><svg class="icon"><use xlink:href="#closeme"/></svg></span></div></div></nav></div></section></aside></div></main><svg width="0" height="0" class="hidden"><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook"><path d="M437 0H75C33.648.0.0 33.648.0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352.0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter"><path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68.0 01-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043.0-1.924.366-2.643 1.078A3.56 3.56.0 008.766 5.383c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846.0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47.0.929.273 1.705.82 2.388a3.623 3.623.0 002.115 1.291c-.312.08-.641.118-.979.118-.312.0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652.0 002.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422.0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139.0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77.0 001.172-4.892v-.468a7.788 7.788.0 001.84-1.921 8.142 8.142.0 01-2.11.593z"/></symbol><symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V4e2c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5.0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar"><path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916.0 1e2v352c0 33.084 26.916 60 60 60h392c33.084.0 60-26.916 60-60V1e2c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028.0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028.0 20 8.972 20 20v48z"/><path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github"><path d="M255.968 5.329C114.624 5.329.0 120.401.0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384.0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008.0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992.0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584.0 34.368-.32 62.08-.32 70.496.0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab"><path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6.0L12.3 74.8z"/><path d="M12.3 74.7.5 111c-1 3.2.0 6.8 3 8.8l101.6 74-92.5-119z"/><path d="M105 193.7l-38.6-119h-54l92.7 119z"/><path d="M105 193.7l38.7-119H66.4l38.7 119z"/><path d="M105 193.7l38.7-119H198l-93 119z"/><path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/><path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6.0L198 74.8z"/></symbol><symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss"><circle cx="3.429" cy="20.571" r="3.429"/><path d="M11.429 24h4.57C15.999 15.179 8.821 8.001.0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"/><path d="M24 24C24 10.766 13.234.0.0.0v4.571c10.714.0 19.43 8.714 19.43 19.429z"/></symbol><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin"><path d="M437 0H75C33.648.0.0 33.648.0 75v362c0 41.352 33.648 75 75 75h362c41.352.0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="to-top"><path d="M604.501 440.509 325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298.0 36.323s26.223 10.024 36.222.0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221.0 9.999-10.023 9.999-26.298.0-36.323z"/></symbol><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly"><path d="M504.971 239.029 448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255.0-24 10.745-24 24s10.745 24 24 24h44c19.851.0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002.0 004e2 320v108c0 19.851-16.149 36-36 36h-44c-13.255.0-24 10.745-24 24s10.745 24 24 24h44c46.318.0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568.0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255.0 24-10.745 24-24S205.255.0 192 0h-44c-46.318.0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568.0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255.0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851.0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002.0 00112 192z"/></symbol><symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy"><path d="M23 2.75A2.75 2.75.0 0020.25.0H8.75A2.75 2.75.0 006 2.75v13.5A2.75 2.75.0 008.75 19h11.5A2.75 2.75.0 0023 16.25zM18.25 14.5h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5zm0-3h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5zm0-3h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5z"/><path d="M8.75 20.5A4.255 4.255.0 014.5 16.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752.0 001 5.25v16A2.752 2.752.0 003.75 24h12a2.752 2.752.0 002.75-2.75v-.75z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme"><path d="M284.286 256.002 506.143 34.144c7.811-7.811 7.811-20.475.0-28.285-7.811-7.81-20.475-7.811-28.285.0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285.0-7.81 7.811-7.811 20.475.0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475.0 28.285a19.938 19.938.0 0014.143 5.857 19.94 19.94.0 0014.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475.0-28.285L284.286 256.002z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu"><path d="M492 236H20c-11.046.0-20 8.954-20 20s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954.0 96s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046.0-20 8.954-20 20s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram"><path d="M12 2.163c3.204.0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849.0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204.0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849.0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741.0 8.333.014 7.053.072c-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.668.072 4.948c.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24s3.668-.014 4.948-.072c4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948s-.014-3.667-.072-4.947c-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403.0-6.162 2.759-6.162 6.162S8.597 18.163 12 18.163s6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zM12 16c-2.209.0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796.0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795.0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="youtube"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23.0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23.0C23.512 20.55 23.971 18.196 24 12c-.029-6.185-.484-8.549-4.385-8.816zM9 16V8l8 3.993L9 16z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow"><path d="M21 27v-8h3v11H0V19h3v8h18z"/><path d="M17.1.2 15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8 13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="xing"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></symbol></svg><footer class=footer><div class="footer_inner wrap pale"><img src=https://h1pmnh.github.io/icons/apple-touch-icon.png class="icon icon_2 transparent" alt="A developer's notes in the world of security research and bug bounty, by pmnh"><p>Copyright&nbsp;<span class=year></span>&nbsp;A DEVELOPER'S NOTES IN THE WORLD OF SECURITY RESEARCH AND BUG BOUNTY, BY PMNH. All Rights Reserved</p><a class=to_top href=#documentTop><svg class="icon"><title>to-top</title><use xlink:href="#to-top"/></svg></a></div></footer><script type=text/javascript src=https://h1pmnh.github.io/en/js/bundle.19668860ea177cfe8cad686c7464b57e39acde1a4c33f6a1a8c57f7ab127ac39e8330b38e7184422cf0e9351ef3efaf75d122eca818d38a929941b8a5c04b09e.js integrity="sha512-GWaIYOoXfP6MrWhsdGS1fjms3hpMM/ahqMV/erEnrDnoMws45xhEIs8Ok1HvPvr3XRIuyoGNOKkplBuKXASwng==" crossorigin=anonymous></script>
<script src=https://h1pmnh.github.io/js/search.min.8a7989a3155833e5032fb922caab1294cb74fa70ec9dd2d720a230b8405586447e2e017e6eff69c3d91da71078850ced1543f1cb71d2822e4faab818381c4f1e.js></script></body></html>